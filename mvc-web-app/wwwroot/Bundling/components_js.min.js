ns("Resinplast.Indicadores.Web.Components.Ajax");Resinplast.Indicadores.Web.Components.Ajax=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.Ajax.prototype={form:null,content:null,action:null,data:null,updatePanel:null,updateForm:null,objectCall:null,showLoading:null,targetLoading:null,autoSubmit:null,ajaxRequest:null,"async":null,method:null,dataType:null,processData:null,hasFile:null,CONTENT_TYPE_POST:"application/json; charset=utf-8",CONTENT_TYPE_GET:"text/json;",CONTENT_TYPE_FORM:"application/x-www-form-urlencoded",divProgress:null,init:function(n){this.async=this.async==!1?!1:!0;this.method=this.method?this.method:"POST";this.dataType=this.dataType?this.dataType:"json";this.showLoading=this.showLoading==!1?!1:!0;n&&(this.form=n.form&&n.form!=null?document.getElementById(n.form):null,this.content=n.content?document.getElementById(n.content):null,this.action=n.action&&n.action!=null?n.action:this.form!=null&&this.action==null?this.form.action:this.action,this.data=n.data?n.data:{},this.updatePanel=n.updatePanel?$("#"+n.updatePanel):null,this.dataType=n.dataType?n.dataType:this.dataType&&this.dataType!=null?this.dataType:"json",this.method=n.method?n.method:"POST",this.async=n.async==!1?n.async:!0,this.processData=n.processData==!1?n.processData:!0,this.hasFile=n.hasFile==!0?n.hasFile:!1,this.onSuccess=n.onSucces?n.onSucces:null,this.onSuccess=n.onSuccess&&this.onSuccess==null?n.onSuccess:this.onSuccess,this.onError=n.onError?n.onError:this.onError,this.autoSubmit=n.autoSubmit==!1?n.autoSubmit:!0,this.showLoading=n.showLoading==!1?n.showLoading:!0,this.targetLoading=n.targetLoading,this.updateForm=n.updateForm&&n.updateForm!=null?document.getElementById(n.updateForm):null,this.autoSubmit&&this.submit())},dataJsonToForm:function(n){var i,t;if(n&&n!=null)for(i=null,t=0;t<this.updateForm.elements.length;t++)this.updateForm.elements[t].name&&this.updateForm.elements[t].name!=""&&(i=n[this.updateForm.elements[t].name],this.updateForm.elements[t].type.toUpperCase()=="RADIO"||this.updateForm.elements[t].type.toUpperCase()=="CHECKBOX"?(i==null&&(i=!1),this.updateForm.elements[t].checked=i):(i==null&&(i=""),this.updateForm.elements[t].value=i))},formToDataJSon:function(){var n,t;for(this.data=this.data?this.data:{},n=0;n<this.form.elements.length;n++)this.form.elements[n].name&&this.form.elements[n].name!=""&&(this.form.elements[n].type.toUpperCase()=="RADIO"||this.form.elements[n].type.toUpperCase()=="CHECKBOX"?this.form.elements[n].checked&&(this.data[this.form.elements[n].name]!=null?(typeof this.data[this.form.elements[n].name]=="string"&&(t=this.data[this.form.elements[n].name],this.data[this.form.elements[n].name]=null,this.data[this.form.elements[n].name]=[],this.data[this.form.elements[n].name][0]=t),this.data[this.form.elements[n].name][this.data[this.form.elements[n].name].length]=this.form.elements[n].value.toString().trim().toUpperCase()):this.data[this.form.elements[n].name]=this.form.elements[n].value.toString().trim().toUpperCase()):this.data[this.form.elements[n].name]=this.form.elements[n].value.toString().trim().toUpperCase());return this.data},contentToDataJSon:function(){var i,u;this.data=this.data?this.data:{};var n=null,t="",r=this.content.getElementsByTagName("*");for(i=0;i<r.length;i++)n=r[i],(n.name&&n.name!=""||n.id&&n.id!="")&&(t=n.id&&n.id!=""?n.id:"",t=n.name&&n.name!=""?n.name:t,n.type.toUpperCase()=="RADIO"||n.type.toUpperCase()=="CHECKBOX"?n.checked&&(this.data[t]=n.value,this.data[t]!=null?(typeof this.data[t]=="string"&&(u=this.data[t],this.data[t]=null,this.data[t]=[],this.data[t][0]=u),this.data[t][this.data[t].length]=n.value):this.data[t]=n.value):this.data[t]=n.value);return this.data},submit:function(n,t){var i,r,u;if(typeof this.form=="string"&&(this.form=document.getElementById(this.form)),this.action==null&&this.form!=null&&(this.action=this.form.action),this.ajaxRequest!=null&&this.abort(),this.form!=null&&this.formToDataJSon(),this.content!=null&&this.contentToDataJSon(),i=this,r={type:this.method,url:this.action,"async":this.async,cache:!1,contentType:this.hasFile?!1:this.dataType.toUpperCase()=="SCRIPT"?this.CONTENT_TYPE_FORM:this.method.toUpperCase()=="GET"?this.CONTENT_TYPE_GET:this.CONTENT_TYPE_POST,dataType:this.dataType,data:this.method.toUpperCase()=="GET"||this.hasFile?this.data:JSON.stringify(this.data),processData:this.processData,customParams:i.customParams,beforeSend:function(){i.showLoading==!0&&(i.loading==null&&i.implementLoading(),i.loading.setValue(!1),i.loading.show())}},t)for(u in t)r[u]=t[u];this.ajaxRequest=$.ajax(r);this.ajaxRequest.done(function(t){if(t!=null&&t.Error!=undefined&&t.Error!=null&&t.Error.Code!=0){if(alert(t.Error.Message),i.onError)i.onError(t.Error)}else if(i.updateForm!=null&&i.dataJsonToForm(t),i.updatePanel!=null&&i.updatePanel.html(t),i.showLoading==!0&&i.loading!=null&&i.loading.setValue(!1),i.onSuccess&&i.onSuccess!=null)i.onSuccess(t,n);i.data=null});this.ajaxRequest.fail(function(n,t,r){if(!(t=="abort"&&r=="abort")&&i.onError)i.onError(r,t,n);i.data=null});this.ajaxRequest.always(function(){i.showLoading==!0&&i.loading!=null&&i.loading.hide()})},send:function(n,t,i){this.data=n&&n!=null?n:this.data;this.onSuccess=t?t:this.onSuccess;this.onError=i?i:this.onError;this.submit()},loading:null,implementLoading:function(){this.loading=new Resinplast.Indicadores.Web.Components.ProgressBar({targetLoading:this.targetLoading})},abort:function(){this.ajaxRequest&&this.ajaxRequest.abort()},onSuccess:null,onError:null};ns("Resinplast.Indicadores.Web.Components");Resinplast.Indicadores.Web.Components.Calendar=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.Calendar.prototype={inputFrom:null,inputTo:null,divDateRange:null,btnToDay:null,styleBtnToDay:null,init:function(n){var i,t;n&&(this.inputFrom=n.inputFrom?n.inputFrom:null,this.inputTo=n.inputTo?n.inputTo:null,this.divDateRange=n.divDateRange?n.divDateRange:null,this.btnToDay=n.btnToDay!=undefined&&n.btnToDay!=null?n.btnToDay:!0,this.styleBtnToDay=this.btnToDay?"linked":!1,i=this);t={format:Resinplast.Indicadores.Web.Global.Format.Date.toLowerCase(),language:Resinplast.Indicadores.Web.Global.Format.Language.toLowerCase(),todayHighlight:i.btnToDay,todayBtn:i.styleBtnToDay,autoclose:!0};this.inputFrom&&this.inputFrom!=null&&(this.inputFrom.datepicker(t),this.inputFrom.keypress(function(n){return validarFormatoFecha(this,n)}),this.inputFrom.change(fnFormsReset()));this.inputTo&&this.inputTo!=null&&(this.inputTo.datepicker(t),this.inputTo.keypress(function(n){return validarFormatoFecha(this,n)}),this.inputTo.change(fnFormsReset()));this.divDateRange&&this.divDateRange!=null&&this.divDateRange.datepicker(t)},destroy:function(){this.inputFrom&&this.inputFrom.datepicker("destroy");this.inputTo&&this.inputTo.datepicker("destroy")}};ns("Resinplast.Indicadores.Web.Components");Resinplast.Indicadores.Web.Components.Dialog=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.Dialog.prototype={idDivDialog:"divDialogResinplast",noCloseButtonClass:"no-close-dialog",init:function(n){this._privateFunction.createDialog.apply(this,[n])},setCloseOnEscape:function(n){this.divDialog&&this.divDialog.progressbar("option","closeOnEscape",n)},setCloseText:function(n){this.divDialog&&this.divDialog.dialog("option","closeText",n)},setDraggable:function(n){this.divDialog&&this.divDialog.dialog("option","draggable",n)},setHeight:function(n){this.divDialog&&this.divDialog.dialog("option","height",n)},setWidth:function(n){this.divDialog&&this.divDialog.dialog("option","width",n)},setMaxHeight:function(n){this.divDialog&&this.divDialog.dialog("option","maxHeight",n)},setMaxWidth:function(n){this.divDialog&&this.divDialog.dialog("option","maxWidth",n)},setMinHeight:function(n){this.divDialog&&this.divDialog.dialog("option","minHeight",n)},setMinWidth:function(n){this.divDialog&&this.divDialog.dialog("option","minWidth",n)},setModal:function(n){this.divDialog&&this.divDialog.dialog("option","modal",n)},setPosition:function(n){this.divDialog&&this.divDialog.dialog("option","position",n)},setResizable:function(n){this.divDialog&&this.divDialog.dialog("option","resizable",n)},setTitle:function(n){this.divDialog&&this.divDialog.dialog("option","title",n)},setClass:function(n){this.divDialog&&this.divDialog.dialog("option","dialogClass",n)},setButtons:function(n){this.divDialog&&this.divDialog.dialog("option","buttons",n)},getMainContainer:function(){return this.divDialog},getHeight:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("option","height")),n},getWidth:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("option","width")),n},getPosition:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("option","position")),n},getTitle:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("option","title")),n},isModal:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("option","modal")),n},isResizable:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("option","resizable")),n},isOpen:function(n){var n=undefined;return this.divDialog&&(n=this.divDialog.dialog("isOpen")),n},close:function(){this.divDialog&&this.isOpen()&&this.divDialog.dialog("close")},open:function(){this.divDialog&&!this.isOpen()&&(navigator.userAgent.indexOf("Chrome")!=-1&&($(window).scrollTop(0),$("body").scrollTop(0)),this.close,this.divDialog.dialog("open"),$("body").css("overflow","hidden"),$(".ui-dialog-titlebar-close").prop("title",""),$(".ui-dialog").css("overflow","visible"),Codebase.helper("core-fn-uiHandleForms"),Codebase.helper("core-tab"),applyToolTipButtons(this.divDialog),applyToolTipForce(this.divDialog))},moveToTop:function(){this.divDialog&&this.divDialog.dialog("moveToTop")},setContent:function(n){this.divDialog&&this.divDialog.html(n)},getAjaxContent:function(n){var t=this,i=new Resinplast.Indicadores.Web.Components.Ajax({action:n.action,dataType:"html",data:n.data,onSuccess:function(i){t.setContent(i);n.onSuccess&&n.onSuccess.apply(n.scope?n.scope:t,[i,n.customParam]);n.autoOpen=n.autoOpen==undefined||n.autoOpen==null?!0:n.autoOpen;n.autoOpen&&(t.open(),n.afterOpen&&n.afterOpen.apply(n.scope?n.scope:t,[i,n.customParam]))}})},destroy:function(){this.divDialog&&(this.divDialog.dialog("destroy"),this.divDialog.remove())},_privateFunction:{createDialog:function(n){this.divDialog=n.target&&n.target!=""?$("#"+n.target):this._privateFunction.implementDialogElement.apply(this,[n]);this.divDialog.dialog(this._privateFunction.getConfig.apply(this,[n]))},implementDialogElement:function(){var n=$("<div />").uniqueId();return this.idDivDialog=this.idDivDialog+n.attr("id"),n.attr("id",this.idDivDialog),$("body").append(n),n},getConfig:function(n){var t={autoOpen:n.autoOpen?n.autoOpen:!1,modal:n.modal?n.modal:!0,resizable:n.resizable?n.resizable:!1,show:{effect:"clip",duration:400},hide:{effect:"clip",duration:50},close:function(){$("body").css("overflow","auto")},showCloseButton:n.showCloseButton?n.showCloseButton:!1,closeOnEscape:n.showCloseButton?n.showCloseButton:!1},i;if(n){for(i in n)t[i]=n[i];t.showCloseButton==!1&&(t.dialogClass=t.dialogClass?t.dialogClass+" "+this.noCloseButtonClass:this.noCloseButtonClass);n.close&&n.close!=null&&(t.close=function(){$("body").css("overflow","auto");n.close()})}return t}}};ns("Resinplast.Indicadores.Web.Components");Resinplast.Indicadores.Web.Components.Grid=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.Grid.prototype={identity:null,slickGrid:null,columns:null,dataView:null,showHeaderRow:null,explicitInitialization:null,renderTo:null,editable:null,enableAddRow:null,enableCellNavigation:null,autoEdit:null,divGrid:null,divPager:null,checkboxSelector:null,pager:null,isPager:null,isPagerauto:null,isPagerpageSize:null,isCheckboxSelector:null,isRadioButtonSelector:null,isServerPaging:null,serverProxy:null,autoHeight:null,forceFitColumns:null,fixedColumns:!1,forceOrderData:null,inlineFilters:null,selectActiveRow:null,defaultHeight:"100",defaultWidth:"100%",width:null,minWidth:null,height:null,minHeight:null,headerRowHeight:null,applyTooltip:null,showHeaderCheckBox:null,showExportarExcel:null,namePropertyData:null,nameFileExcel:null,groupItemMetadataProvider:null,onLoad:null,onBeforeLoad:null,onToggleCheckboxRowSelection:null,tempDataSelected:null,isGetAll:!1,idGridStorage:null,columnSizeOptional:null,indicatorGridInPopup:!1,init:function(n){n&&(this.renderTo="#"+n.renderTo,this.divGrid=$(this.renderTo),this.width=n.width?n.width:null,this.height=n.height?n.height:null,this.showExportarExcel=n.showExportarExcel!=null?n.showExportarExcel:!1,this.defaultHeight=n.defaultHeight?n.defaultHeight:25,this.applyTooltip=n.applyTooltip&&n.applyTooltip!=null?n.applyTooltip:!0,this.isPager=n.isPager&&n.isPager!=null?n.isPager:!1,this.isPagerauto=n.isPagerauto&&n.isPagerauto!=null?n.isPagerauto:"15",this.isPagerpageSize=n.isPagerpageSize&&n.isPagerpageSize!=null?n.isPagerpageSize:Resinplast.Indicadores.Web.Global.Grid.Options.PagerpageSize,this.isCheckboxSelector=n.isCheckboxSelector&&n.isCheckboxSelector!=null?n.isCheckboxSelector:!1,this.isRadioButtonSelector=n.isRadioButtonSelector&&n.isRadioButtonSelector!=null?n.isRadioButtonSelector:!1,this.isServerPaging=n.isServerPaging&&n.isServerPaging!=null?n.isServerPaging:!1,this.editable=n.editable?n.editable:!0,this.enableAddRow=n.enableAddRow?n.enableAddRow:!1,this.enableCellNavigation=n.onError?n.onError:!0,this.autoEdit=n.autoEdit?n.autoEdit:!0,this.autoHeight=n.autoHeight!=undefined&&n.autoHeight!=null?n.autoHeight:!0,this.forceFitColumns=n.forceFitColumns?n.forceFitColumns:!1,this.fixedColumns=n.fixedColumns!=undefined&&n.fixedColumns!=null?n.fixedColumns:!1,this.forceOrderData=n.forceOrderData?n.forceOrderData:!1,this.inlineFilters=n.inlineFilters?n.inlineFilters:!1,this.selectActiveRow=n.selectActiveRow?n.selectActiveRow:!1,this.groupItemMetadataProvider=n.groupItemMetadataProvider?n.groupItemMetadataProvider:null,this.namePropertyData=n.namePropertyData?n.namePropertyData:null,this.nameFileExcel=n.nameFileExcel?n.nameFileExcel:null,this.headerRowHeight=n.headerRowHeight?n.headerRowHeight:30,this.showHeaderRow=n.showHeaderRow?n.showHeaderRow:!1,this.showHeaderCheckBox=n.showHeaderCheckBox!=null&&n.showHeaderCheckBox!=undefined?n.showHeaderCheckBox:!0,this.explicitInitialization=n.explicitInitialization?n.explicitInitialization:!1,this.columns=n.columns,this.onLoad=n.onLoad?n.onLoad:null,this.onBeforeLoad=n.onBeforeLoad?n.onBeforeLoad:null,this.onToggleCheckboxRowSelection=n.onToggleCheckboxRowSelection?n.onToggleCheckboxRowSelection:null,this.idGridStorage=this.renderTo,n.proxy&&(this.setServerProxy(n.proxy),this.idGridStorage=this.idGridStorage+"/"+this.serverProxy.ajax.action),this.tempDataSelected=[],this.columnSizeOptional=n.columnSizeOptional?n.columnSizeOptional:"43",this.indicatorGridInPopup=n.indicatorGridInPopup?n.indicatorGridInPopup:!1);this.formatGrid();this.createGrid();this.idGridStorage=this.idGridStorage==null?"CurrentStatePage":this.idGridStorage;Resinplast.Indicadores.Web.Global.Grid.Options.PreventPageState&&Resinplast.Indicadores.Web.Global.Grid.Options.PreventPageState!=null&&this.loadCurrentStatePage()},getView:function(){return this.slickGrid},getDataView:function(){return this.slickGrid.getData()},getColumns:function(){return this.slickGrid.getColumns()},createGrid:function(){var n;this.createDataView();this.createSelector();this.slickGrid=new Slick.Grid(this.renderTo,this.dataView,this.columns,{editable:this.editable,enableAddRow:this.enableAddRow,enableCellNavigation:this.enableCellNavigation,autoEdit:this.autoEdit,autoHeight:this.autoHeight,forceFitColumns:this.forceFitColumns,enableColumnReorder:this.fixedColumns,headerRowHeight:this.headerRowHeight,showHeaderRow:this.showHeaderRow,explicitInitialization:this.explicitInitialization,enableTextSelectionOnCells:!0,columnSizeOptional:this.columnSizeOptional,indicatorGridInPopup:this.indicatorGridInPopup});this.slickGrid.getCanvas().css("min-height","35px");this.createRowSelectionModel();this.createPager(this.isPagerauto,this.isPagerpageSize);this.createExportExcel();this.registerPlugin();this.implementsEvent();n=this;$.browser.msie&&(n=this,$(window).scroll(function(){var t=n.slickGrid.getViewportSelector().scrollLeft();n.slickGrid.getViewportSelector().scrollLeft(t==0?t+1:t-1);n.slickGrid.getViewportSelector().scrollLeft(t)}));this.implementsToolTip()},implementsToolTip:function(){this.applyTooltip&&applyToolTipGrid(this.divGrid)},implementsEvent:function(){var n=this;this.enableAddRow==!0&&this.slickGrid.onAddNewRow.subscribe(function(t,i){i.item.id=n.identity;n.getDataView().addItem(i.item);n.identity++})},implementsSort:function(){var n=this;this.forceOrderData==!0&&this.slickGrid.onSort.subscribe(function(t,i){var r=i.sortCol.field,u=i.sortAsc?1:-1;n.getDataView().sort(function(n,t){value1=n[r];value2=t[r];return(value1==value2?0:value1>value2?1:-1)*u})})},createDataView:function(){var n=this;this.dataView=new Slick.Data.DataView({inlineFilters:this.inlineFilters,groupItemMetadataProvider:this.groupItemMetadataProvider});this.dataView.onRowCountChanged.subscribe(function(){n.slickGrid.updateRowCount();n.slickGrid.render()});this.dataView.onRowsChanged.subscribe(function(t,i){n.slickGrid.invalidateRows(i.rows);n.slickGrid.render()})},createRowSelectionModel:function(){this.slickGrid.setSelectionModel(new Slick.RowSelectionModel({selectActiveRow:this.selectActiveRow}))},createSelector:function(){var n=this;this.isCheckboxSelector?(this.checkboxSelector=new Slick.CheckboxSelectColumn({cssClass:"slick-cell-checkboxsel",toolTip:Resinplast.Indicadores.Web.Shared.General.Resources.EtiquetaSeleccionarDeseleccionarTodos,showHeaderCheckBox:this.showHeaderCheckBox,onToggleRowSelection:function(t,i){var r=n.slickGrid.getData().getItemById(t);if(i||(n.tempDataSelected=$.grep(n.tempDataSelected,function(n){return n.RowId!=r.RowId})),n.onToggleCheckboxRowSelection&&n.onToggleCheckboxRowSelection!=null)n.onToggleCheckboxRowSelection([r],i)},onHeaderClick:function(t){if(t)this.pager&&this.pager!=null&&n.getPageInfo().totalRows>0&&(n.closeToolTip(),n.load(!0),n.implementsToolTip());else{if(n.onToggleCheckboxRowSelection&&n.onToggleCheckboxRowSelection!=null)n.onToggleCheckboxRowSelection(n.tempDataSelected,!1);n.tempDataSelected=[]}}}),this.columns.splice(0,0,this.checkboxSelector.getColumnDefinition())):this.isRadioButtonSelector&&(this.checkboxSelector=new Slick.RadioSelectColumn({cssClass:"slick-cell-checkboxsel",toolTip:"",onToggleRowSelection:function(t,i){if(i){var r=n.slickGrid.getData().getItemById(t);n.tempDataSelected=[];n.tempDataSelected.push(r)}}}),this.columns.splice(0,0,this.checkboxSelector.getColumnDefinition()))},createPager:function(n,t){if(this.isPager){this.createFooter();var i=this;this.pager=new Slick.Controls.Pager(this.dataView,this.slickGrid,this.divFooter,{defaultPageSize:t,onPageChange:function(){i.tempDataSelected||(i.tempDataSelected=[]);i.isRadioButtonSelector?i.getSelectionData().length>1?$.each(i.getSelectionData(),function(n,t){var r=!0;return $.each(i.tempDataSelected,function(n,i){if(t.RowId==i.RowId)return r=!1}),r?(i.tempDataSelected=[],i.tempDataSelected.push(t),!1):void 0}):i.tempDataSelected=i.getSelectionData():i.isCheckboxSelector&&$.each(i.getSelectionData(),function(n,t){var r=!0;$.each(i.tempDataSelected,function(n,i){if(t.RowId==i.RowId)return r=!1});r&&i.tempDataSelected.push(t)});i.load();i.clearPreventStatePage();Resinplast.Indicadores.Web.Components.Storage.Set(i.idGridStorage,i.getCurrentStatePage());i.onPageChange&&i.onPageChange()},isServerPaging:this.isServerPaging})}},createFooter:function(){var n=this.divGrid.attr("id")+"Pager";$("#"+n).length>0&&$("#"+n).remove();this.divFooter=$("<div />");this.divFooter.attr("id",n);this.divFooter.css("width",this.width);this.indicatorGridInPopup&&this.divFooter.css("padding-bottom","50px");this.divGrid.after(this.divFooter)},createExportExcel:function(){var n,t,i;this.showExportarExcel&&(this.divFooter||this.createFooter(),n=null,t='<button type="button" class="btn btn-alt-success mr-5 mb-5" style="float:right"><i class="fa fa-download mr-5"><\/i>Excel<\/button>',n=this.isPager?$(t).appendTo(this.divFooter.find("div").first()):$(t).appendTo(this.divFooter),i=this,n.click(function(){i.exportGrid()}))},exportGrid:function(){var n=this.getDataView().getItems();this.isServerPaging==!0&&n.length>0?this.exportServerPagination():this.exportClientPagination()},exportServerPagination:function(){var n={},t,i;n.ExportarExcel="cookie"+Date.now();this.namePropertyData!=null&&(n.NombrePropiedad=this.namePropertyData);this.nameFileExcel!=null&&(n.NombreArchivoExcel=this.nameFileExcel);t=this.serverProxy.ajax.action;this.serverProxy.ajax.action+=this.serverProxy.ajax.action.indexOf("?")!=-1?"&":"?";this.serverProxy.ajax.action+=$.param(n);i=this.getColumDefinition();Cookies.set(n.ExportarExcel,i,{expires:10,path:"/"});this.load(!0);this.serverProxy.ajax.action=t},exportClientPagination:function(){var n=this.getColumDefinition(),u=this.getDataView().getItems(),i=[],r=[],t;$.each(u,function(t,r){var e=[],u,f;for(u in n){f=null;switch(!0){case u.toUpperCase().indexOf("FECHAJULIANA")!=-1:f=r[u]?r[u]===!0?"âœ”":r[u]===!1?"":r[u]:"";break;case u.toUpperCase().indexOf("FECHA")!=-1:f=r[u]?moment(r[u]).format(Resinplast.Indicadores.Web.Global.Format.DateTimeGrid):"";f.indexOf("00:00:00")!=-1&&(f=r[u]?moment(r[u]).format(Resinplast.Indicadores.Web.Global.Format.DateGrid):"");break;case u.toUpperCase().indexOf("HORA")!=-1:f=r[u]?moment(r[u]).format(Resinplast.Indicadores.Web.Global.Format.HourGrid):"";break;default:f=r[u]}e.push(f)}i.push(e)});for(t in n)r.push(n[t]?n[t]:"");this.setServerProxy({action:Resinplast.Indicadores.Web.General.DescargaArchivo.Actions.ExportarGrid,data:{listData:i,listHeading:r,nombreSesion:"ckresinplastExport"+Date.now(),nombreArchivo:this.nameFileExcel}});this.serverProxy.ajax.submit(this)},getColumDefinition:function(){var n={};return $.each(this.columns,function(t,i){var r=i.name&&i.name!=null&&i.name.trim()!=""&&i.name.indexOf("<input")==-1,u=i.field&&i.field!=null&&i.field.trim()!=""&&i.field.indexOf("<input")==-1;r&&u&&(n[i.field]=i.name)}),n},formatGrid:function(){this.divGrid.css("background-color","white");this.divGrid.css("margin-bottom","10px");this.width!=null?this.divGrid.css("width",this.width):this.divGrid.css("width",this.defaultWidth);this.height!=null?(this.autoHeight=!1,this.divGrid.height(this.height)):this.autoHeight==!1&&this.divGrid.height(this.defaultHeight)},registerPlugin:function(){(this.isCheckboxSelector||this.isRadioButtonSelector)&&this.slickGrid.registerPlugin(this.checkboxSelector);this.groupItemMetadataProvider!=null&&this.slickGrid.registerPlugin(this.groupItemMetadataProvider);this.slickGrid.registerPlugin(new Slick.AutoColumnSize)},setAutoColumnSize:function(){var n=new Slick.AutoColumnSize;n.init(this.slickGrid);n.resizeAllColumns()},clearData:function(){this.setData({ErrorCode:0,ErrorDescription:"",ListData:[]})},setData:function(n){if(n.ErrorCode!=null&&n.ErrorCode!=0)this.slickGrid.getCanvas().html('<div style="text-align:left;font-style:italic;padding-left:10px">'+n.ErrorCode+" - "+n.ErrorDescription+"<\/div>");else{n=n.ListData;var t=[];$.each(n,function(n,i){var r=jQuery.extend({},i);r.id=n;t.push(r)});this.slickGrid.getData().beginUpdate();this.slickGrid.getData().setItems(t);this.slickGrid.getData().endUpdate();this.isServerPaging==!0&&this.slickGrid.invalidate();this.isPager==!0&&this.isServerPaging!=!0&&this.pager.updateSizePage();t.length==0&&(this.defaultHeight=-1,this.slickGrid.getCanvas().html('<div style="text-align:left;font-style:italic;padding-left:10px">'+Resinplast.Indicadores.Web.Shared.General.Resources.EtiquetaResultadosBusquedaVacia+"<\/div>"));this.configureAutoHeight();this.identity=t.length;this.forceFitColumns&&this.setAutoColumnSize();this.implementsSort();this.implementsToolTip()}},setDataList:function(n){var t=[];$.each(n,function(n,i){var r=jQuery.extend({},i);r.id=n;t.push(r)});this.slickGrid.getData().beginUpdate();this.slickGrid.getData().setItems(t);this.slickGrid.getData().endUpdate();this.isServerPaging==!0&&this.slickGrid.invalidate();this.isPager==!0&&this.isServerPaging!=!0&&this.pager.updateSizePage();t.length==0&&(this.defaultHeight=-1,this.slickGrid.getCanvas().html('<div style="text-align:left;font-style:italic;padding-left:10px">'+Resinplast.Indicadores.Web.Shared.General.Resources.EtiquetaResultadosBusquedaVacia+"<\/div>"));this.configureAutoHeight();this.identity=t.length;this.forceFitColumns&&this.setAutoColumnSize();this.implementsToolTip()},configureAutoHeight:function(){var n=this.getDataView().getItems().length*this.getView().getOptions().rowHeight;this.autoHeight==!0&&(n<this.defaultHeight?(this.divGrid.height(this.defaultHeight+2),this.slickGrid.setOptions({autoHeight:!1}),this.slickGrid.resizeCanvas()):(this.slickGrid.setOptions({autoHeight:!0}),this.divGrid.css("height","auto"),this.slickGrid.getViewportSelector().css("height","auto"),this.slickGrid.resizeCanvas()))},setFilter:function(n){this.dataView.setFilter(n)},addItem:function(n){this.slickGrid.getData().beginUpdate();this.slickGrid.getData().addItem(n);this.slickGrid.getData().endUpdate()},getSelectionData:function(){var i=this.slickGrid.getSelectedRows(),n=[],t=this;return $.each(i,function(i,r){var u=t.slickGrid.getData().getItemById(r);n.push(u)}),$.each(t.tempDataSelected,function(t,i){var r=!0;$.each(n,function(n,t){if(i.RowId==t.RowId)return r=!1});r&&n.push(i)}),n},getSelectionDataFilter:function(){var t=this.slickGrid.getSelectedRows(),n=[],i=this;return $.each(t,function(t,r){var u=i.slickGrid.getData().getItem(r);n.push(u)}),n},getSelectedRows:function(){return this.slickGrid.getSelectedRows()},setSelectedRows:function(n){this.slickGrid.setSelectedRows(n)},setSelectedAll:function(){this.isServerPaging==!0&&this.load(!0);var t=this.getDataView().getItems(),n=[];$.each(t,function(t,i){n.push(i.id)});this.slickGrid.setSelectedRows(n)},setServerProxy:function(n){n&&(this.serverProxy==null&&(this.serverProxy={ajax:new Resinplast.Indicadores.Web.Components.Ajax({autoSubmit:!1,onSuccess:function(n,t){var i,n,r,u;if(n&&n.EsExportacionExcel){redirectPost(Resinplast.Indicadores.Web.General.DescargaArchivo.Actions.DescargarArchivo,{nombreSesion:n.NombreSesion});return}if(t.onBeforeLoad&&(i=t.onBeforeLoad(n),n=i?i:n),t.isGetAll){if(t.isGetAll=!1,t.tempDataSelected=n,t.onToggleCheckboxRowSelection&&t.onToggleCheckboxRowSelection!=null)t.onToggleCheckboxRowSelection(t.tempDataSelected,!0)}else if(t.setData(n),this.isPager&&t.pager.isServerPaging&&t.pager.processData(n),n=t.getDataView().getItems(),r=[],$.each(n,function(n,i){$.each(t.tempDataSelected,function(n,t){if(i.RowId==t.RowId)return r.push(i.id),!1})}),t.slickGrid.setSelectedRows(r),t.isCheckboxSelector&&t.checkboxSelector!=null&&this.isPager&&(u=t.tempDataSelected.length==t.getPageInfo().totalRows&&t.getPageInfo().totalRows>0,t.checkboxSelector.changeStateHeader(u)),t.onLoad)t.onLoad(n)}}),params:null}),this.serverProxy.ajax.action=n.action?n.action:this.serverProxy.ajax.action,this.serverProxy.params=n.data?n.data:this.serverProxy.params,this.serverProxy.ajax.data=this.serverProxy.params)},load:function(n,t){if(this.serverProxy!=null){if(this.isGetAll=n!=undefined?n:!1,this.isPager&&this.pager.isServerPaging){var i=this.getPageInfo();this.serverProxy.params.PageSize=n?i.totalRows*1.2:this.pager.serverPageInfo.pageSize;this.serverProxy.params.PageNo=n?1:this.pager.serverPageInfo.pageNum+1}this.serverProxy.ajax.data=this.serverProxy.params;this.serverProxy.ajax.submit(this,t)}},getPageInfo:function(){var n=null;return this.pager&&this.pager!=null&&(n=this.pager.isServerPaging?this.pager.serverPageInfo:this.dataView.getPagingInfo()),n},getCurrentStatePage:function(){var n=this.getPageInfo(),t=null;return n&&n!=null&&(t={PageSize:n.pageSize,Page:n.pageNum+1}),t},setCurrentStatePage:function(n,t){var i=this.getPageInfo();i&&i!=null&&(i.pageNum=n-1,i.pageSize=t)},loadCurrentStatePage:function(){var n=Resinplast.Indicadores.Web.Components.Storage.Get(this.idGridStorage);n&&n!=null&&this.setCurrentStatePage(n.Page,n.PageSize)},clearPreventStatePage:function(){Resinplast.Indicadores.Web.Global.Grid.Options.PreventPageState=null},destroy:function(){this.slickGrid.destroy()},closeToolTip:function(){this.divGrid.tooltip("destroy")}};ns("Resinplast.Indicadores.Web.Components.Message");Resinplast.Indicadores.Web.Components.Message=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.Message.prototype={init:function(n){this._privateFunction.createMessage.apply(this,[n]);ResultConfirm=!1},ResultConfirm:!1,Information:function(n){swal.setDefaults({confirmButtonClass:"btn btn-hero btn-outline-info m-5"});typeof n=="undefined"?(n=[],n.title=Resinplast.Indicadores.Web.Shared.Message.Resources.Informacion,n.message=null):(n.title=n.title?n.title:Resinplast.Indicadores.Web.Shared.Message.Resources.Informacion,n.message=n.message?n.message:null);n.type="info";this._privateFunction.show.apply(this,[n])},Success:function(n){swal.setDefaults({confirmButtonClass:"btn btn-hero btn-outline-success m-5",timer:3e3});typeof n=="undefined"?(n=[],n.title=Resinplast.Indicadores.Web.Shared.Message.Resources.Exito,n.message=null):(n.title=n.title?n.title:"Exito",n.message=n.message?n.message:null);n.type="success";this._privateFunction.show.apply(this,[n])},SuccessNoTime:function(n){swal.setDefaults({confirmButtonClass:"btn btn-hero btn-outline-success m-5"});typeof n=="undefined"?(n=[],n.title=Resinplast.Indicadores.Web.Shared.Message.Resources.Exito,n.message=null):(n.title=n.title?n.title:Resinplast.Indicadores.Web.Shared.Message.Resources.Exito,n.message=n.message?n.message:null);n.type="success";this._privateFunction.show.apply(this,[n])},Warning:function(n){swal.setDefaults({confirmButtonClass:"btn btn-hero btn-outline-warning m-5"});typeof n=="undefined"?(n=[],n.title=Resinplast.Indicadores.Web.Shared.Message.Resources.Advertencia,n.message=null):(n.title=n.title?n.title:"Advertencia",n.message=n.message?n.message:null);n.type="warning";this._privateFunction.show.apply(this,[n])},Error:function(n){swal.setDefaults({confirmButtonClass:"btn btn-hero btn-outline-danger m-5"});typeof n=="undefined"?(n=[],n.title=Resinplast.Indicadores.Web.Shared.Message.Resources.Error,n.message=null):(n.title=n.title?n.title:Resinplast.Indicadores.Web.Shared.Message.Resources.Error,n.message=n.message?n.message:null);n.type="error";this._privateFunction.show.apply(this,[n])},_privateFunction:{createMessage:function(){swal.setDefaults({buttonsStyling:!1,focusConfirm:!1,confirmButtonClass:"btn btn-lg btn-alt-success m-5",cancelButtonClass:"btn btn-lg btn-alt-danger m-5",inputClass:"form-control",allowOutsideClick:!1})},show:function(n){swal(n.title,n.message,n.type)}}};ns("Resinplast.Indicadores.Web.Components");Resinplast.Indicadores.Web.Components.ProgressBar=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.ProgressBar.prototype={isProgressBar:null,idDivDialog:"divProgressDialogResinplast",idDivProgrees:"divProgressResinplast",idDivLoading:"divLoadingResinplast",init:function(n){this.isProgressBar=n.isProgressBar?n.isProgressBar:!1;this._privateFunction.createProgressBar.apply(this,[n])},setMaxValue:function(n){this.divProgress&&this.divProgress.progressbar("option","max",n)},setValue:function(n){this.divProgress&&this.divProgress.progressbar("option","value",n)},getValue:function(){var n=null;return this.divProgress&&(n=this.divProgress.progressbar("option","value")),n},show:function(){this.divDialog?this.divDialog.dialog("open"):this.divProgress&&this.divProgress.show()},hide:function(){this.divDialog?this.divDialog.dialog("close"):this.divProgress?this.divProgress.hide():this.divLoading.hide()},destroy:function(){this.divProgress&&(this.divProgress.progressbar("destroy"),this.divProgress.remove());this.divLoading&&this.divLoading.remove();this.divDialog&&(this.divDialog.dialog("destroy"),this.divDialog.remove())},_privateFunction:{createProgressBar:function(n){n.targetLoading?n.targetLoading=$("#"+n.targetLoading):(this.divDialog=this._privateFunction.implementDialogElement.apply(this,[n]),n.targetLoading=this.divDialog);this.isProgressBar?this.divProgress=this._privateFunction.implementProgressElement.apply(this,[n.targetLoading,n.maxValue]):(n.targetLoading.addClass("bg-transparent"),this.divLoading=this._privateFunction.implementLoading.apply(this,[n.targetLoading]))},implementProgressElement:function(n,t){var i=$("#"+this.idDivProgrees),r,u;return i.length==0&&(i=$("<div />"),i.attr("id",this.idDivProgrees),i.addClass("progressBar-resinplast"),i.append($('<div class="progressBar-resinplast-label"><\/div>')),Resinplast.Indicadores.Web.Shared.General.Resources&&i.find(".progressBar-resinplast-label").text(Resinplast.Indicadores.Web.Shared.General.Resources.EtiquetaCargando),n.append(i)),n&&(i.css("position","relative"),i.css("top","0px"),i.css("left","0px")),r=this,u={value:t?0:!1,change:function(){r.getValue()!=!1&&i.find(".progressBar-resinplast-label").text(r.getValue()+"%")}},t&&(u.max=t),i.progressbar(u),i},implementLoading:function(n){var t=$("#"+this.idDivLoading);return t.length==0&&(t=$("<div />"),t.attr("id",this.idDivLoading),t.addClass("text-center"),t.append($('<i class="fa fa-5x fa-refresh fa-spin text-resinplast-azul"><\/i>')),n.append(t)),n&&(t.css("position","relative"),t.css("top","0px"),t.css("left","0px")),t},implementDialogElement:function(n){var t=$("#"+this.idDivDialog);return t.length==0&&(t=$("<div />"),t.attr("id",this.idDivDialog),$("body").append(t)),t.dialog({dialogClass:"no-close-progress",closeOnEscape:!1,width:220,modal:n.modal?n.modal:!0,resizable:!1,title:"Loading..."}),t}}};ns("Resinplast.Indicadores.Web.Components.Storage");Resinplast.Indicadores.Web.Components.Storage={Exists:function(n){var t=sessionStorage.getItem(n);return t!=null},Get:function(n){return JSON.parse(sessionStorage.getItem(n))},Set:function(n,t){sessionStorage.setItem(n,JSON.stringify(t))},Remove:function(n){sessionStorage.removeItem(n)}};ns("Resinplast.Indicadores.Web.Components.Validator");Resinplast.Indicadores.Web.Components.Validator=function(n){this.init(n)};Resinplast.Indicadores.Web.Components.Validator.prototype={form:null,messages:null,validator:null,init:function(n){if(n&&(this.form=n.form?$("#"+n.form):null,this.messages=n.messages?n.messages:null,this.form!=null)){this.validator=this.form.validate();var t=Resinplast.Indicadores.Web.Global.Format.Language.toLowerCase();typeof t!="undefined"&&$.extend($.validator.messages,$.validator.messages[t]);this.validator.settings.errorClass="invalid-feedback animated fadeInDown";this.validator.settings.errorElement="div";this.validator.settings.errorPlacement=function(n,t){$(t).parents(".form-group > div").append(n)};this.validator.settings.highlight=function(n){$(n).closest(".form-group > div").addClass("is-invalid")};this.validator.settings.unhighlight=function(n){$(n).closest(".form-group > div").removeClass("is-invalid")};this.validator.settings.success=function(n){$(n).closest(".form-group").removeClass("is-invalid");$(n).remove()};this.configure()}},configure:function(){var n=this,t={},i={};n.form.find("[validable]").each(function(){var u=$(this).attr("name"),c,f,o;u==undefined&&(c=$(this).attr("id"),$(this).attr("name",c),u=$(this).attr("name"));var l=Resinplast.Indicadores.Web.Shared.Message.Resources.ValidacionDebeIngresar+" ",p=l?l:"Por favor, debe ingresar ",a={},v={},y=$(this).attr("validable").split(",");for(f=0;f<y.length;f++){var e=$.trim(y[f]).split(" "),s=$.trim(e[0]),o=s=="required",r=$.trim(e[1]),h;r=="true"?o=!0:r=="false"?o=!1:$.isNumeric(r)?o=parseFloat(r):h=r;e.length>2&&(h=$.trim(e[2]));a[s]=o;v[s]=p+n.messages[h]}t[u]=a;i[u]=v});n.validator.settings.rules=t;n.validator.settings.messages=i},isValid:function(){var n=!0;return this.validator.form(),n=this.validator.valid(),n||this.validator.focusInvalid(),n},reset:function(){this.validator.resetForm();this.validator.reset()}};